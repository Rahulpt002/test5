<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Checkout - {{ course.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style> body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; padding:2rem; } .btn{padding:.6rem 1rem; background:#0a7; color:#fff; border:0; border-radius:6px;} </style>
</head>
<body>
  <h2>Checkout: {{ course.title }}</h2>
  <p>Amount: â‚¹{{ amount_display }}</p>
  <button id="rzp-button1" class="btn">Pay Now</button>

  <form id="callback" method="post" action="{% url 'payment_callback' %}" style="display:none;">
    {% csrf_token %}
    <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id" />
    <input type="hidden" name="razorpay_order_id" id="razorpay_order_id" />
    <input type="hidden" name="razorpay_signature" id="razorpay_signature" />
  </form>

  <script>
    const options = {
      key: "{{ razorpay_key_id }}",
      amount: "{{ amount }}",
      currency: "{{ currency }}",
      name: "CourseShop",
      description: "Purchase {{ course.title }}",
      order_id: "{{ order_id }}",
      handler: function (response){
        document.getElementById('razorpay_payment_id').value = response.razorpay_payment_id;
        document.getElementById('razorpay_order_id').value = response.razorpay_order_id;
        document.getElementById('razorpay_signature').value = response.razorpay_signature;
        document.getElementById('callback').submit();
      },
      prefill: {},
      theme: { color: "#0a7" }
    };
    const rzp1 = new Razorpay(options);
    document.getElementById('rzp-button1').onclick = function(e){
      rzp1.open();
      e.preventDefault();
    }
  </script>
</body>
</html>


